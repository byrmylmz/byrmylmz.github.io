{"hash":"36769a3991ca3fc2866a7dd0c4d7ef372d08b32d","data":{"post":{"title":"Laraval Digital Ocean Deploy","date":"December 20, 2021","content":"<h2 id=\"\"><img src=\"https://images.unsplash.com/photo-1588421357574-87938a86fa28?ixlib=rb-1.2.1&#x26;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&#x26;auto=format&#x26;fit=crop&#x26;w=1770&#x26;h=200\"></h2>\n<p><a href=\"https://www.youtube.com/watch?v=GhGDunq_OSw\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Deploy Laravel to DigitalOcean Youtube</a></p>\n<p><a href=\"https://www.digitalocean.com/community/tutorials/how-to-install-and-configure-laravel-with-lemp-on-ubuntu-18-04\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Digital Ocean Explanation</a></p>\n<h3 id=\"connection\"><a href=\"#connection\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Connection</h3>\n<p>test</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #d8dee9ff\">ssh root@server_ip_adress</span></span></code></pre>\n<h3 id=\"server-set-up\"><a href=\"#server-set-up\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Server set up</h3>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">adduser name_of_user</span></span>\n\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">usermod </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">aG sudo name_of_user</span></span>\n\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\"> name_of_user</span></span>\n\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">mkdir </span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">ssh</span></span>\n\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">chmod </span><span style=\"color: #B48EAD\">700</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">ssh</span></span>\n\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">vim </span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">ssh</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">authorized_keys  </span><span style=\"color: #616E88\">// vim or nano</span></span>\n\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">cat </span><span style=\"color: #81A1C1\">~/</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">ssh</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">id_rsa</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">pub </span><span style=\"color: #616E88\">// in your computers terminal cat the public key</span></span></code></pre>\n<h3 id=\"firewall-configuration\"><a href=\"#firewall-configuration\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Firewall configuration</h3>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo ufw allow </span><span style=\"color: #ECEFF4\">&#39;</span><span style=\"color: #A3BE8C\">Nginx HTTP</span><span style=\"color: #ECEFF4\">&#39;</span><span style=\"color: #D8DEE9FF\"> </span></span></code></pre>\n<h3 id=\"mysql-configuration\"><a href=\"#mysql-configuration\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Mysql configuration</h3>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo mysql_secure_installation</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo mysql </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">u root </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">p</span></span></code></pre>\n<h3 id=\"mysql-queries\"><a href=\"#mysql-queries\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>MySQL queries</h3>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #d8dee9ff\">create user &#39;username&#39;@&#39;localhost&#39; identified by &#39;password&#39;;\nalter user &#39;username&#39;@&#39;localhost&#39; identified with mysql_native_password by &#39;password&#39;;\ncreate database database_name;\ngrant all on database_name.* to &#39;username&#39;@&#39;localhost&#39;;\nflush privileges;\nexit;</span></span></code></pre>\n<h3 id=\"php-extension\"><a href=\"#php-extension\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>PHP extension</h3>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo apt update</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo apt install php</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">bcmath php</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">mbstring php</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">xml</span></span></code></pre>\n<h3 id=\"composer\"><a href=\"#composer\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Composer</h3>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo apt install unzip</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">curl </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">sS https</span><span style=\"color: #81A1C1\">:</span><span style=\"color: #616E88\">//getcomposer.org/installer |php</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo mv composer</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">phar </span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">usr</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">local</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">bin</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">composer</span></span></code></pre>\n<h3 id=\"clone-and-set-up-the-app\"><a href=\"#clone-and-set-up-the-app\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Clone and set up the app</h3>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo chown name_of_user </span><span style=\"color: #81A1C1\">.</span><span style=\"color: #81A1C1\">/</span></span></code></pre>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">cd </span><span style=\"color: #81A1C1\">/var/</span><span style=\"color: #D8DEE9FF\">www</span><span style=\"color: #81A1C1\">/</span></span></code></pre>\n<h3 id=\"github\"><a href=\"#github\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Github</h3>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">git </span><span style=\"color: #81A1C1\">clone</span><span style=\"color: #D8DEE9FF\"> url_from_github</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">cd repo_name</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">composer install</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">cp </span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">env</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">example </span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">env</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">php artisan generate</span><span style=\"color: #81A1C1\">:</span><span style=\"color: #D8DEE9FF\">key</span></span>\n<span class=\"line\"><span style=\"color: #616E88\">// vim or nano</span></span></code></pre>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">vim </span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">env</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">php artisan migrate </span><span style=\"color: #81A1C1\">--</span><span style=\"color: #D8DEE9FF\">force</span></span></code></pre>\n<h3 id=\"nginx-configuration\"><a href=\"#nginx-configuration\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Nginx configuration</h3>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo vim </span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">etc</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">nginx</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">sites</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">available</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">tutorial</span></span></code></pre>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #616E88\">// nginx configuration</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">server </span><span style=\"color: #ECEFF4\">{</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    listen </span><span style=\"color: #B48EAD\">80</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    server_name DOMAIN_NAME_OR_IP_ADDRESS</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    root </span><span style=\"color: #81A1C1\">/var/</span><span style=\"color: #D8DEE9FF\">www</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">name_of_repo</span><span style=\"color: #81A1C1\">/public;</span></span>\n\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    add_header X</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">Frame</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">Options </span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #A3BE8C\">SAMEORIGIN</span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    add_header X</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">XSS</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">Protection </span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #A3BE8C\">1; mode=block</span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    add_header X</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">Content</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">Type</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">Options </span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #A3BE8C\">nosniff</span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #81A1C1\">;</span></span>\n\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    index index</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">html index</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">htm index</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">php</span><span style=\"color: #81A1C1\">;</span></span>\n\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    charset utf</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #B48EAD\">8</span><span style=\"color: #81A1C1\">;</span></span>\n\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    location </span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">        try_files </span><span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">uri</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">uri</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">index</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">php</span><span style=\"color: #81A1C1\">?$</span><span style=\"color: #D8DEE9\">query_string</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    }</span></span>\n\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    location </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">favicon</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">ico </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> access_log </span><span style=\"color: #81A1C1\">off;</span><span style=\"color: #D8DEE9FF\"> log_not_found </span><span style=\"color: #81A1C1\">off;</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    location </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">robots</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">txt  </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> access_log </span><span style=\"color: #81A1C1\">off;</span><span style=\"color: #D8DEE9FF\"> log_not_found </span><span style=\"color: #81A1C1\">off;</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span></span>\n\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    error_page </span><span style=\"color: #B48EAD\">404</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">index</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">php</span><span style=\"color: #81A1C1\">;</span></span>\n\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    location </span><span style=\"color: #81A1C1\">~</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">php$ </span><span style=\"color: #ECEFF4\">{</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">        fastcgi_pass unix</span><span style=\"color: #81A1C1\">:/var/</span><span style=\"color: #D8DEE9FF\">run</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">php</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">php7</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #B48EAD\">4</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">fpm</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">sock</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">        fastcgi_index index</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">php</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">        fastcgi_param SCRIPT_FILENAME </span><span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">realpath_root</span><span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">fastcgi_script_name</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">        </span><span style=\"color: #81A1C1\">include</span><span style=\"color: #D8DEE9FF\"> fastcgi_params</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #ECEFF4\">}</span></span>\n\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    location </span><span style=\"color: #81A1C1\">~</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">/</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #81A1C1\">?!</span><span style=\"color: #D8DEE9FF\">well</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">known)</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #81A1C1\">*</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">        deny all</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #ECEFF4\">}</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">}</span></span></code></pre>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo ln </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">s </span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">etc</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">nginx</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">sites</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">available</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">tutorial </span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">etc</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">nginx</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">sites</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">enabled</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">tutorial</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo nginx </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">t </span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo service nginx restart</span></span></code></pre>\n<h3 id=\"change-owner-of-storage-and-bootstrapcache\"><a href=\"#change-owner-of-storage-and-bootstrapcache\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Change owner of storage and bootstrap/cache</h3>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">cd path</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">to</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">repo</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo chown </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">R www</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">data</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">www</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">data storage</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo chown </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">R www</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">data</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">www</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">data bootstrap</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">cache</span></span></code></pre>\n","fileInfo":{"extension":".md","directory":"blog","path":"blog/2020-12-20-digital-ocean.md","name":"2020-12-20-digital-ocean"},"tags":[{"title":"laravel","path":"/tag/laravel/"},{"title":"deploy","path":"/tag/deploy/"}]}},"context":{}}