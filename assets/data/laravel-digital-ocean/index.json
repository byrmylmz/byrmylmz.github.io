{"hash":"3dd8f27471d6cb5d33b2f7d105c74ef1f575fe2e","data":{"post":{"title":"Laraval Digital Ocean Deploy","date":"December 20, 2021","content":"<h2 id=\"commands\"><a href=\"#commands\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>COMMANDS</h2>\n<p><strong><em>Server set up</em></strong></p>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">adduser name_of_user</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">usermod </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">aG sudo name_of_user</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\"> name_of_user</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">mkdir </span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">ssh</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">chmod </span><span style=\"color: #B48EAD\">700</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">ssh</span></span>\n<span class=\"line\"><span style=\"color: #616E88\">// vim or nano</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">vim </span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">ssh</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">authorized_keys </span></span>\n<span class=\"line\"><span style=\"color: #616E88\">// in your computers terminal cat the public key</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">cat </span><span style=\"color: #81A1C1\">~/</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">ssh</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">id_rsa</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">pub</span></span></code></pre>\n<p><strong><em>Firewall configuration</em></strong></p>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo ufw allow </span><span style=\"color: #ECEFF4\">&#39;</span><span style=\"color: #A3BE8C\">Nginx HTTP</span><span style=\"color: #ECEFF4\">&#39;</span><span style=\"color: #D8DEE9FF\"> </span></span></code></pre>\n<p><strong><em>Mysql configuration</em></strong></p>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo mysql_secure_installation</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo mysql </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">u root </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">p</span></span></code></pre>\n<p><strong><em>MySQL queries</em></strong></p>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">create user </span><span style=\"color: #ECEFF4\">&#39;</span><span style=\"color: #A3BE8C\">username</span><span style=\"color: #ECEFF4\">&#39;</span><span style=\"color: #81A1C1\">@</span><span style=\"color: #ECEFF4\">&#39;</span><span style=\"color: #A3BE8C\">localhost</span><span style=\"color: #ECEFF4\">&#39;</span><span style=\"color: #D8DEE9FF\"> identified by </span><span style=\"color: #ECEFF4\">&#39;</span><span style=\"color: #A3BE8C\">password</span><span style=\"color: #ECEFF4\">&#39;</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">alter user </span><span style=\"color: #ECEFF4\">&#39;</span><span style=\"color: #A3BE8C\">username</span><span style=\"color: #ECEFF4\">&#39;</span><span style=\"color: #81A1C1\">@</span><span style=\"color: #ECEFF4\">&#39;</span><span style=\"color: #A3BE8C\">localhost</span><span style=\"color: #ECEFF4\">&#39;</span><span style=\"color: #D8DEE9FF\"> identified with mysql_native_password by </span><span style=\"color: #ECEFF4\">&#39;</span><span style=\"color: #A3BE8C\">password</span><span style=\"color: #ECEFF4\">&#39;</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">create database database_name</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">grant all </span><span style=\"color: #81A1C1\">on</span><span style=\"color: #D8DEE9FF\"> database_name</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #81A1C1\">*</span><span style=\"color: #D8DEE9FF\"> to </span><span style=\"color: #ECEFF4\">&#39;</span><span style=\"color: #A3BE8C\">username</span><span style=\"color: #ECEFF4\">&#39;</span><span style=\"color: #81A1C1\">@</span><span style=\"color: #ECEFF4\">&#39;</span><span style=\"color: #A3BE8C\">localhost</span><span style=\"color: #ECEFF4\">&#39;</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">flush privileges</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #81A1C1\">exit;</span></span></code></pre>\n<p><strong><em>PHP extension</em></strong></p>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo apt update</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo apt install php</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">bcmath php</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">mbstring php</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">xml</span></span></code></pre>\n<p><strong><em>Composer</em></strong></p>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo apt install unzip</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">curl </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">sS https</span><span style=\"color: #81A1C1\">:</span><span style=\"color: #616E88\">//getcomposer.org/installer |php</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo mv composer</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">phar </span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">usr</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">local</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">bin</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">composer</span></span></code></pre>\n<p><strong><em>Clone and set up the app</em></strong></p>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo chown name_of_user </span><span style=\"color: #81A1C1\">.</span><span style=\"color: #81A1C1\">/</span></span></code></pre>\n<p><strong><em>github</em></strong></p>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">git </span><span style=\"color: #81A1C1\">clone</span><span style=\"color: #D8DEE9FF\"> url_from_github</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">cd repo_name</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">composer install</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">cp </span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">env</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">example </span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">env</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">php artisan generate</span><span style=\"color: #81A1C1\">:</span><span style=\"color: #D8DEE9FF\">key</span></span>\n<span class=\"line\"><span style=\"color: #616E88\">// vim or nano</span></span></code></pre>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">vim </span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">env</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">php artisan migrate </span><span style=\"color: #81A1C1\">--</span><span style=\"color: #D8DEE9FF\">force</span></span></code></pre>\n<p><strong><em>Nginx configuration</em></strong></p>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo vim </span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">etc</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">nginx</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">sites</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">available</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">tutorial</span></span>\n<span class=\"line\"><span style=\"color: #616E88\">// nginx configuration</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">server </span><span style=\"color: #ECEFF4\">{</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    listen </span><span style=\"color: #B48EAD\">80</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    server_name DOMAIN_NAME_OR_IP_ADDRESS</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    root </span><span style=\"color: #81A1C1\">/var/</span><span style=\"color: #D8DEE9FF\">www</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">name_of_repo</span><span style=\"color: #81A1C1\">/public;</span></span>\n\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    add_header X</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">Frame</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">Options </span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #A3BE8C\">SAMEORIGIN</span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    add_header X</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">XSS</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">Protection </span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #A3BE8C\">1; mode=block</span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    add_header X</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">Content</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">Type</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">Options </span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #A3BE8C\">nosniff</span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #81A1C1\">;</span></span>\n\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    index index</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">html index</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">htm index</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">php</span><span style=\"color: #81A1C1\">;</span></span>\n\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    charset utf</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #B48EAD\">8</span><span style=\"color: #81A1C1\">;</span></span>\n\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    location </span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">        try_files </span><span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">uri</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">uri</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">index</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">php</span><span style=\"color: #81A1C1\">?$</span><span style=\"color: #D8DEE9\">query_string</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    }</span></span>\n\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    location </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">favicon</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">ico </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> access_log </span><span style=\"color: #81A1C1\">off;</span><span style=\"color: #D8DEE9FF\"> log_not_found </span><span style=\"color: #81A1C1\">off;</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    location </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">robots</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">txt  </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> access_log </span><span style=\"color: #81A1C1\">off;</span><span style=\"color: #D8DEE9FF\"> log_not_found </span><span style=\"color: #81A1C1\">off;</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span></span>\n\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    error_page </span><span style=\"color: #B48EAD\">404</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">index</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">php</span><span style=\"color: #81A1C1\">;</span></span>\n\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    location </span><span style=\"color: #81A1C1\">~</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">php$ </span><span style=\"color: #ECEFF4\">{</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">        fastcgi_pass unix</span><span style=\"color: #81A1C1\">:/var/</span><span style=\"color: #D8DEE9FF\">run</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">php</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">php7</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #B48EAD\">4</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">fpm</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">sock</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">        fastcgi_index index</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">php</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">        fastcgi_param SCRIPT_FILENAME </span><span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">realpath_root</span><span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">fastcgi_script_name</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">        </span><span style=\"color: #81A1C1\">include</span><span style=\"color: #D8DEE9FF\"> fastcgi_params</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #ECEFF4\">}</span></span>\n\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    location </span><span style=\"color: #81A1C1\">~</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">/</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #81A1C1\">?!</span><span style=\"color: #D8DEE9FF\">well</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">known)</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #81A1C1\">*</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">        deny all</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #ECEFF4\">}</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">}</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo ln </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">s </span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">etc</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">nginx</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">sites</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">available</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">tutorial </span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">etc</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">nginx</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">sites</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">enabled</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">tutorial</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo nginx </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">t </span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo service nginx restart</span></span></code></pre>\n<p><strong><em>Change owner of storage and bootstrap/cache</em></strong></p>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">cd path</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">to</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">repo</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo chown </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">R www</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">data</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">www</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">data storage</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">sudo chown </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">R www</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">data</span><span style=\"color: #81A1C1\">.</span><span style=\"color: #D8DEE9FF\">www</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\">data boostrap</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">cache</span></span></code></pre>\n","fileInfo":{"extension":".md","directory":"blog","path":"blog/2020-12-20-digital-ocean.md","name":"2020-12-20-digital-ocean"},"tags":[{"title":"laravel","path":"/tag/laravel/"},{"title":"deploy","path":"/tag/deploy/"}]}},"context":{}}